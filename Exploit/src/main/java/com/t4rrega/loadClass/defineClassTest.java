package com.t4rrega.loadClass;

import java.lang.reflect.Method;
import java.nio.file.Files;
import java.nio.file.Paths;

public class defineClassTest {
    public static void main(String[] args) throws Exception {

        ClassLoader systemClassLoader = ClassLoader.getSystemClassLoader();

        Method defineClassMethod = ClassLoader.class.getDeclaredMethod("defineClass", String.class, byte[].class, int.class, int.class);
        defineClassMethod.setAccessible(true);
        byte[] code = Files.readAllBytes(Paths.get("/Users/t4rrega/JavaProjects/javaDemo/target/classes/test.class"));
        Class defineclass = (Class) defineClassMethod.invoke(systemClassLoader, "test", code, 0, code.length);
        defineclass.newInstance();

    }
}